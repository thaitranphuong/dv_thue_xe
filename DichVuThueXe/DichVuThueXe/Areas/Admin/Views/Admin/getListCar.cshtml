@model Tuple<PagedList.IPagedList<DichVuThueXe.Models.Xe>, string>
@using PagedList.Mvc;
@using DichVuThueXe.Models
@{
    ViewBag.Title = "getListCar";
    Layout = "~/Areas/Admin/Views/Shared/_Layout.cshtml";
}

<script>
    window.onload = function () {
        var searchParams = new URLSearchParams(window.location.search);
        var ten = searchParams.get("ten");
        if (ten !== null) {
            document.getElementById("timdichvu").value = ten;
        }
    }

    function showSearch() {
        var search = $('#timdichvu').val();
        $.ajax({
            url: '/Admin/Admin/getListCar',
            type: "GET",
            data: { ten: search },
            success: function (data) {
                document.getElementById("timdichvu").value = search;
                window.location.href = '/Admin/Admin/getListCar?ten=' + encodeURIComponent(search);
            }
        });
    }
</script>
<style>
    thead, th {
        background-color: lightblue;
    }
</style>
<br />
<div class="col-lg-12">
    <h1 class="page-header" style="color: lightblue;">DANH SÁCH XE</h1>
</div>
<div class="search" style="padding-left: 50% ">
    <input id="timdichvu" class="search__input" type="text" placeholder="Tìm tên xe">
    <button id="btn-timkiem" class="btn btn-bitbucket" onclick="showSearch()"><img src="~/Content/image/search.png" alt="search" width="15"></button>
</div>
<table class="table">
    <thead>
        <tr>
            <th style="color: white">
                Mã xe
            </th>
            <th style="color: white">
                Tên xe
            </th>
            <th style="color: white">
                Số chỗ
            </th>
            <th style="color: white">
                Trạng thái
            </th>
            <th style="color: white">
                Hình ảnh
            </th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model.Item1)
        {
            <tr>
                <td>
                    @Html.DisplayFor(modelItem => item.MaXe)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.TenXe)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.SoCho)
                </td>
                <td>
                    @if (item.TrangThai == true)
                    {
                        <div class="d-flex mb-3">
                            <p class="price ml-auto" style="color:green">Còn xe</p>
                        </div>
                    }
                    else
                    {
                        <div class="d-flex mb-3">
                            <p class="price ml-auto" style="color: red">Đã hết xe</p>
                        </div>
                    }
                </td>
                <td>
                    <img src="@Url.Content("/Content/images/" + item.HinhAnhs.First().URL)" width="100px" />
                </td>
            </tr>
        }
    </tbody>
</table>
<div style="margin-left:20px;">
    @Html.PagedListPager(Model.Item1, page => Url.Action("getListCar", new { ten = Model.Item2, page }))
</div>